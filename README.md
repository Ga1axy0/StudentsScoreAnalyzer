# 成绩可视化看板（多次考试）

本应用基于 Streamlit，支持一次性上传多个 Excel 成绩文件，按自定义顺序（支持拖拽或表格编辑）展示学生的成绩与排名随考试的变化：

- 多文件上传与自定义排序（侧边栏可编辑顺序与考试标签，可选拖拽排序）
- 单学生：
  - 可选择任意一次考试查看该学生各科成绩柱状图
  - 总分跨考试柱状对比
  - 跨考试成绩对比（按科目分类，颜色区分考试，不含总分）
  - 跨考试校次排名对比（全部科目 + 总分 分组柱状图，名次轴自动反转）
  - 多次考试总分校次排名变化折线图（名次越小越靠上，X 轴=考试标签）
  - 各科校次排名雷达图（可选 2-3 次考试叠加对比）
  - 全部考试的成绩明细表（行=考试标签，列=科目/含总分）与排名明细表
- 多学生：选择多个学生在同一张折线图中对比排名变化
- 下载合并后的原始数据 CSV
 - 侧边栏支持“班级”筛选，所有图表和下载均以筛选后数据为准

## Excel 列结构假设

建议统一列结构，至少包含以下列（缺失列将自动忽略或标成未知列）：

```
准考证号, 班级, 姓名, 总分, 总分_校次, 总分_班次,
语文, 语文_校次, 语文_班次,
数学, 数学_校次, 数学_班次,
英语, 英语_校次, 英语_班次,
物理, 物理_校次, 物理_班次,
化学, 化学_校次, 化学_班次,
生物, 生物_校次, 生物_班次
```

> 若你的文件列名不完全一致，应用会按固定顺序重命名前若干列，其余列保留为 `未知列*`。

## 拖拽排序支持

默认使用表格编辑顺序。若希望使用“拖拽”方式排序考试：

```powershell
pip install streamlit-sortables
```

安装后侧边栏会出现拖拽区块，可直接拖动考试重新排序。

## 本地运行（Windows PowerShell）

```powershell
# 1. （可选）创建并激活虚拟环境
python -m venv .venv
.\.venv\Scripts\Activate.ps1

# 2. 安装依赖
pip install -r requirements.txt

# 3. 运行应用
streamlit run gy.py
```

运行后在浏览器打开的页面中：
- 侧边栏上传多个 Excel 文件
- 在数据表中编辑“自定义顺序”和“考试标签”
- 侧边栏选择“班级”筛选（默认全选）
- 选择学生与对比对象，查看折线图/雷达图、任意考试成绩柱状图、指定科目跨考试对比图

## 常见问题

- 雷达图为什么面积越大越好？
  - 我们对“名次”做了反转归一，名次越靠前，雷达值越大，面积越大。
- 没有显示某个科目？
  - 该科目的列可能在文件中缺失或命名不规范，检查列是否存在相应的 `科目`、`科目_校次` 列。
- 排名轴为什么是反的？
  - 折线图中 `y` 轴做了反转（名次越小越靠上），便于直观理解。

## 自定义科目

侧边栏中的“科目列表(逗号分隔)”可以调整参与展示的科目，例如：

```
语文, 数学, 英语
```

保存后图表会基于新的科目集更新。
